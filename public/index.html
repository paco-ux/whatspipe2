<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WhatsPipe</title>
  <style>
    :root{
      --bg:#0f1924;
      --card:#111f2b;
      --muted:#6f879a;
      --txt:#e5f1ff;
      --accent:#2dd4bf;
      --accent-2:#22c55e;
      --danger:#ef4444;
      --line:#1e3141;
      --pill:#0e2434;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--txt);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      line-height:1.35;
    }
    .container{max-width:1100px;margin:24px auto;padding:0 16px}
    h1{font-size:28px;margin:10px 0 20px}
    h2{font-size:22px;margin:28px 0 12px}
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:14px;
      padding:18px;
      margin-bottom:16px;
    }
    label{display:block;font-size:13px;color:var(--muted);margin:6px 0 6px}
    input,select,textarea,button{
      font:inherit;color:inherit;
    }
    input,select,textarea{
      width:100%;
      background:#0c1721;
      border:1px solid var(--line);
      border-radius:12px;
      padding:12px 14px;
      outline:none;
      color:var(--txt);
    }
    input::placeholder, textarea::placeholder{color:#88a2b7;opacity:.55}
    select:disabled{opacity:.6}
    .row{display:grid;gap:16px}
    .row-2{grid-template-columns:1.2fr .8fr}
    .row-3{grid-template-columns:1fr 1fr 1fr}
    @media (max-width:860px){
      .row-2,.row-3{grid-template-columns:1fr}
    }

    /* Pills */
    .pills{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      border-radius:999px;border:1px solid var(--line);
      background:var(--pill);color:var(--txt);
      padding:10px 14px;cursor:pointer;user-select:none;
      transition:all .15s ease;
    }
    .pill.active{outline:2px solid var(--accent)}
    .pill .icon{font-size:18px}
    .muted{color:var(--muted)}
    small{color:var(--muted)}
    .right{display:flex;justify-content:flex-end}

    /* Table (scroll interno) */
    .table-wrap{
      background:#0c1721;border:1px solid var(--line);
      border-radius:12px;overflow:hidden;
      max-height:360px; /* scroll interno */
      overflow-y:auto;margin-top:12px;
    }
    table{width:100%;border-collapse:collapse}
    thead th{
      position:sticky;top:0;background:#0d1a25;
      font-weight:600;color:#a9c3d6;z-index:1;
      text-align:left;padding:12px 14px;border-bottom:1px solid var(--line)
    }
    tbody td{
      padding:12px 14px;border-bottom:1px solid var(--line);
      vertical-align:top;
    }
    tbody tr{cursor:pointer}
    tbody tr:hover{background:#0e1d29}
    .tag{display:inline-block;background:#0d2536;border:1px solid #0f3246;
      color:#9fd3ff;border-radius:999px;padding:3px 8px;margin:2px;font-size:12px}

    /* Buttons */
    .btn{
      border:none;border-radius:12px;padding:12px 16px;
      background:#153449;color:#eafff8;font-weight:600;cursor:pointer;
      transition:transform .06s ease, background .15s ease;
    }
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:var(--accent-2);color:#052012}
    .btn-outline{background:transparent;border:1px solid var(--line)}
    .btn-block{width:100%}
    .btn-small{padding:6px 10px;border-radius:8px;font-size:13px}

    .actions{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media (max-width:720px){.actions{grid-template-columns:1fr}}
    .link{font-size:13px;color:#a7f3d0;text-decoration:underline;cursor:pointer}

    textarea{min-height:140px;resize:vertical}

    .header{
      display:flex;align-items:center;gap:14px;margin-bottom:6px
    }
    .logo{height:36px;width:auto}
    .subtitle{color:#a6bfce}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img class="logo" src="./logo.png" alt="WhatsPipe" onerror="this.style.display='none'">
      <h1>WhatsPipe</h1>
    </div>
    <p class="subtitle">Usa plantillas de Notion y datos de tu deal en Pipedrive para generar mensajes listos para WhatsApp.</p>

    <!-- 1) Cargar datos desde Pipedrive -->
    <section class="card">
      <h2>1) Cargar datos desde Pipedrive</h2>
      <div class="row row-2">
        <div>
          <label for="pipedriveId">Link o ID de Pipedrive</label>
          <input id="pipedriveId" placeholder="https://empresa.pipedrive.com/deal/12345 o 12345" />
          <small>Puede ser URL o solo el n√∫mero del deal.</small>
        </div>
        <div class="right" style="align-items:flex-end">
          <button id="loadFromPipe" class="btn btn-primary">Cargar desde Pipedrive</button>
        </div>
      </div>
    </section>

    <!-- 2) Datos del contacto -->
    <section class="card">
      <h2>2) Datos del contacto</h2>
      <div class="row row-2">
        <div>
          <label for="contactName">Nombre</label>
          <input id="contactName" placeholder="Ej. Ana L√≥pez" />
        </div>
        <div>
          <label for="contactPhone">Tel√©fono</label>
          <input id="contactPhone" placeholder="Ej. 5512345678 o 521234567890" />
          <small>Se sanea autom√°ticamente; si ingresas 10 d√≠gitos se enviar√° con +52.</small>
        </div>
      </div>
    </section>

    <!-- 3) Plantillas (Notion) -->
    <section class="card">
      <h2>3) Plantillas (desde Notion)</h2>

      <div class="row row-3">
        <div>
          <label for="searchByName">Buscar por nombre</label>
          <input id="searchByName" placeholder="Escribe para filtrar‚Ä¶" />
        </div>

        <div>
          <label for="filterClass">Clase</label>
          <select id="filterClass" disabled>
            <option value="">‚Äî Selecciona ‚Äî</option>
          </select>
        </div>

        <div>
          <label for="filterCategory">Categor√≠a</label>
          <select id="filterCategory" disabled>
            <option value="">‚Äî Selecciona ‚Äî</option>
          </select>
        </div>
      </div>

      <div class="pills">
        <button id="filterFavorites" class="pill" type="button" title="Mostrar solo favoritas">
          <span class="icon">‚≠ê</span> Mis favoritas
        </button>
        <button id="filterMostUsed" class="pill" type="button" title="Ordenar por m√°s usadas">
          <span class="icon">üî•</span> M√°s usadas
        </button>
        <span class="muted">Selecciona <b>Clase</b> y <b>Categor√≠a</b> para ver plantillas.</span>
      </div>

      <div class="table-wrap" style="margin-top:16px">
        <table>
          <thead>
            <tr>
              <th style="width:34%">Nombre</th>
              <th style="width:26%">Clase/Categor√≠a</th>
              <th>Etiquetas</th>
              <th style="width:80px;text-align:right">Usos</th>
            </tr>
          </thead>
          <tbody id="templatesTable">
            <tr><td colspan="4">Selecciona filtros para empezar‚Ä¶</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- 4) Mensaje -->
    <section class="card">
      <h2>4) Mensaje</h2>
      <label for="messageBox" class="sr-only">Mensaje</label>
      <textarea id="messageBox" placeholder="Aqu√≠ aparecer√° el mensaje‚Ä¶"></textarea>

      <div class="actions" style="margin-top:14px">
        <button id="updateWithData" class="btn">Actualizar con datos</button>
        <button id="sendWhatsApp" class="btn btn-primary">Enviar por WhatsApp</button>
      </div>
      <div class="right" style="margin-top:8px">
        <a id="sendEmptyMessage" class="link" href="#">Enviar mensaje vac√≠o</a>
      </div>
    </section>
  </div>

  <script src="./script.js"></script>
</body>
</html>
